


Цель веб-безопасности:

-способы защиты веб-сайтов от несанкционированного доступа, использования, изменения, уничтожения или нарушения работы.

-обеспечение конфиденциальности, целостности и доступности информации.

Для эффективной безопасности веб-сайта необходимо уделять особое внимание к разработке всего веб-сайта: 
-к веб-приложению
-конфигурации веб-сервера,
-при написании политик создания и обновления паролей,
-кода на стороне клиента.

Угрозы :

Межсайтовый скриптинг (XSS)

тип атак, который позволяют злоумышленнику внедрять вредоносный код через веб-сайт в браузеры других пользователей
Уязвимости XSS делятся на отражённые и хранимые:
-Отражённая XSS-уязвимость возникает, когда пользовательский контент, который передаётся на сервер, немедленно и без 
изменений возвращается для отображения в браузере.

-Постоянная уязвимость XSS возникает, когда вредоносный скрипт хранится на веб-сайте, а затем снова отображается 
без изменений, чтобы другие пользователи могли выполнять его невольно.


SQL injection

    Уязвимости SQL-инъекций позволяют злоумышленникам выполнять произвольный код SQL в базе данных, позволяя получать, 
изменять или удалять данные независимо от разрешений пользователя.

Подделка межсайтовых запросов (CSRF)

CSRF-атаки позволяют злоумышленнику выполнять действия, используя учётные данные другого пользователя, 
без его ведома или согласия.

    Clickjacking. 
В этой атаке злоумышленник перехватывает клики, предназначенные для видимого сайта верхнего уровня, и 
направляет их на скрытую ниже страницу. Этот метод можно использовать, например, для отображения законного сайта банка, 
но захвата учётных данных для входа в невидимый <iframe> (en-US) , контролируемый злоумышленником. Clickjacking также 
можно использовать для того, чтобы заставить пользователя нажать кнопку на видимом сайте, но при этом на самом деле
невольно нажимать совершенно другую кнопку. В качестве защиты ваш сайт может предотвратить встраивание себя в iframe на 
другом сайте, установив соответствующие заголовки HTTP.

Denial of Service (DoS). 
DoS обычно достигается за счёт наводнения целевого сайта поддельными запросами, 
так что доступ к сайту нарушается для законных пользователей.

Directory Traversal (Файл и раскрытие).
В этой атаке злоумышленник пытается получить доступ к частям файловой системы 
веб-сервера, к которым у него не должно быть доступа


File Inclusion. 
В этой атаке пользователь может "случайно" указать файл для отображения или выполнения в данных,
передаваемых на сервер

Внедрение команд. Атаки с внедрением команд позволяют злоумышленнику выполнять произвольные системные команды в 
операционной системе хоста


            Политика безопасности контента (CSP)

    Content Security Policy (CSP, политика защиты контента) — это механизм обеспечения безопасности, с помощью которого

можно защищаться от атак с внедрением контента, например, межсайтового скриптинга (XSS, cross site scripting). CSP
описывает безопасные источники загрузки ресурсов, устанавливает правила использования встроенных стилей, скриптов, а
также динамической оценки JavaScript — например, с помощью eval. Загрузка с ресурсов, не входящих в «белый список»,
блокируется.

            HTTPS
HTTPS не является отдельным протоколом. Это обычный HTTP, работающий через шифрованные транспортные механизмы SSL и TLS

            Протокол защиты транспортного уровня (TLS)
Криптографические протоколы, обеспечивающие защищённую передачу данных между узлами в сети Интернет.

TLS и SSL используют асимметричное шифрование для аутентификации, симметричное шифрование для конфиденциальности и коды
аутентичности сообщений для сохранения целостности сообщений.


Совместное использование ресурсов между разными источниками (CORS).
технология современных браузеров, которая позволяет предоставить веб-страницам доступ к ресурсам другого домена.

HTTP Strict-Transport-Security (HSTS)
заголовок ответа (часто используется аббревиатура HSTS (en-US)), позволяющий web-сайтам уведомить браузер о том, 
что доступ к ним должен быть осуществлён только посредством HTTPS вместо HTTP.

    

    Конфиденциальность — обеспечение исключительно авторизованного доступа к информации: информация не 

должна предоставляться и не должна раскрываться неавторизованным физическим лицам, организациям или процессам.

    Целостность — поддержание и обеспечение точности и полноты данных на протяжении всего жизненного цикла: данные 

не должны быть изменены неавторизованным или незаметным способом.

    Доступность — обеспечение беспрепятственного доступа к информации авторизованным пользователям: системы хранения и 

обработки информации, интерфейсы работы с информацией, системы обеспечения авторизованного доступа и каналы связи должны
функционировать корректно.





XSS 

Tри вида наиболее распространенныx XSS-атак:

 -хранимые (код хранится в базе данных);
 -отраженные (код исполняется серверными сценариями и не хранится
в базе данных);
 -через DOM (код сохраняется и выполняется в браузере).


Это запуск в браузере сценария, который написан не владельцем вебприложения.
 Сценарий можно запустить в фоновом режиме; для этого не требуется его отображения или какого-либо пользовательского 
ввода.
 Можно извлекать из веб-приложения данные любого типа. Можно свободно отправлять данные на свой сервер и 
получать их оттуда.
 Он возникает в результате неправильной обработки пользовательского ввода, встроенного в пользовательский интерфейс.
Позволяет воровать сеансовые токены, что дает возможность захватить учетную запись.
 Позволяет отображать объекты DOM поверх пользовательского интерфейса, что приводит к фишинговым атакам, которые 
не в состоянии распознать обычный пользователь.


Хранимый XSS
    Хранимый XSS — загруженный пользователем вредоносный сценарий, который сохраняется в базе данных, а затем при 
запросе и просмотре содержащих его данных другими пользователями выполняется на их устройствах
Тип атаки позволяет поразить множество пользователей, но при этом вредоносный код легко обнаруживается, поскольку 
хранится на стороне сервера.

Отраженный XSS
    Отраженный XSS отличается от сохраненного только тем,
что вредоносный код исполняется напрямую в браузере без ретрансляции через сервер
Обнаружить отраженный XSS гораздо сложнее, так как атаки этого типа нацелены непосредственно на пользователя 
и никогда не сохраняются в базе данных. 
отраженный XSS легко замаскировать под реальную ссылку

XSS-атака на базе DOM
    Это может быть вариант как хранимой, так и отраженной XSS-атаки, но для выполнения требуются источник и приемник
в DOM браузера. Из-за различий в реализациях DOM некоторые браузеры оказываются уязвимыми, некоторые — нет.
Такую XSS-уязвимость гораздо труднее найти.
В отличие от других форм-XSS для атаки через DOM никогда не требуется взаимодействия с сервером. 
Поэтому есть тенденция причислять этот тип атаки к новой категории, называемой XSS на стороне клиента.

XSS с мутациями(mutation-based XSS, mXSS).
    По своей сути mXSS использует
код, который воспринимается фильтрами как безопасный, а после фильтрации
мутирует во вредоносный.

Cпособы защиты

Среди них самые популярные:

 - аудит (превентивная мера);
 - использование защищенных протоколов передачи данных;
 -применение ПО, обеспечивающего безопасность.
Все способы необходимо применять в комплексе.

Проверка сайта на уязвимости:
-Проверка проводится ручным или автоматизированным способом
Программы протестируют приложение на основные риски.Такие программные продукты существуют в двух вариантах: 
1) Black hat-моделирующие действия взломщиков.
2) White hat-планомерно выявляющие все недочеты системы методом сканирования.
   (OpenVAS, OWASP(Xenotix XSS Exploit Framework проверяет сайт на XSS-уязвимость), Approof (изучает конфигурацию веб-приложения и 
находит лишний или вредоносный код), (SecurityHeaders.io проанализирует ответы сервера на запросы и выявит
уязвимые места)


HTTPS
Защищенный протокол передачи данных HTTPS. Hyper Text Transfer Protocol Secure защищает информацию о 
пользователе веб-приложения при помощи шифрования трафика. Он обеспечивает сохранение конфиденциальности
и целостности информации, не допуская утечку или подмену данных.

Обновление ПО

Защита от SQL-инъекций
Этот метод хакерской атаки выглядит как запрос к сайту и его базе данных при помощи поля формы или параметра URL. 
Если при конструировании ресурса применялся язык Transact SQL, в запрос вставляется вредоносный код, 
с легкостью меняющий или уничтожающий данные, содержащиеся в таблицах.

Избежать риска получится, если применять параметризованные запросы, в которых задействовано 
несколько языков программирования, ORM.

Дополнительные способы обеспечения безопасности
Помимо основных перечисленных методов, часто применяются:
-шифрование паролей;
-избегание межсайтового скриптинга;
-контроль загрузки файлов на сервер.


Архитектура защищенного ПО
При планировании архитектуры любого нового продукта или функции нужно обращать пристальное внимание на данные,
которые передаются на всех этапах.В разработке ПО роль архитектора заключается в проектировании модулей на 
высоком уровне и в выборе оптимальных способов их взаимодействия друг с другом.

Глубокий анализ кода
Вопросы:
- Как данные передаются из точки A в точку Б (чаще всего они передаются по сети и в определенном формате)?
- Как хранятся данные?
- Как выглядят данные, когда они попадают к клиенту?
- Каким операциям подвергаются данные на стороне сервера и каким образом они там сохраняются?

Поиск уязвимости
Проверка проводится ручным или автоматизированным способом

Анализ уязвимости
Для определения риска следует рассмотреть такие факторы, как:
-финансовый риск для компании;
-сложность эксплуатации обнаруженной уязвимости;
-тип данных, который будет скомпрометирован;
-существующие договорные соглашения;
-уже принятые меры по смягчению последствий.

Управление уязвимостями

После оценки рисков, которые несет уязвимость, и определения степени ее
приоритетности возникает необходимость отслеживания процесса ее устранения. Ведь исправления должны 
выполняться своевременно, а сроки следует определять на основе оценки рисков

Регрессивное тестирование
-собирательное название для всех видов тестирования программного обеспечения, направленных на 
обнаружение ошибок в уже протестированных участках исходного кода.

Меры по снижению риска
-усилия, направленные на снижение риска возникновения уязвимости в кодовой базе приложения

Прикладные техники разведки и нападения

Защита от XSS
Система шаблонов Django защищает от большинства XSS-атак,  экранируя определённые символы, 
считающиеся "опасными" в HTML. 
Однако существует возможность отключения данной защиты, при котором экранирование не будет автоматически 
применятся ко всем полям, которые не должны будут заполнятся пользователем(к примеру, поле help_text)

Так же XSS-атаки могут быть осуществлены через другие ненадёжные источники данных, такие как cookies, 
сторонние сервисы или загруженные файлы

Межсайтовая подделка запроса (CSRF)
    Механизм защиты заключается в том, что добавляется тег шаблона {% csrf_token %} форму. 
Этот токен будет отображён в HTML  со значением, уникальным для каждого запрашивающего форму пользователя.

Защита от SQL инъекции
ORM

Защита от Кликджекинга
middleware X-Frame-Options, который поддерживается браузерами и может запретить отображение страницы внутри <iframe>.

SSL/HTTPS
SSL/HTTPS может быть использован на веб-сервере для шифрования всего трафика между сервером и пользователем, 
включая данные входа, которые иначе будут отправляться как обычный текст (который сможет прочитать любой 
перехвативший запрос человек).
Если используется HTTPS, Django позволяет использовать следующие методы защиты:
-SECURE_PROXY_SSL_HEADER может быть использовано для проверки что всегда используется безопасное подключение, 
даже если данные поступают из прокси, использующего протокол отличный от HTTP.
-SECURE_SSL_REDIRECT используется для перенаправления всех запросов с HTTP на HTTPS.
-HTTP Strict Transport Security (HSTS). Этот HTTP заголовок информирует браузер о том, что все последующие запросы 
должны всегда использовать HTTPS. Совместно с перенаправлением HTTP запросов на HTTPS, эта опция позволяет обеспечить
использование HTTPS в каждом запросе. HSTS может так же быть настроен опциями SECURE_HSTS_SECONDS и 
SECURE_HSTS_INCLUDE_SUBDOMAINS или на веб-сервере.
-Использует ‘безопасные’ cookies если SESSION_COOKIE_SECURE и CSRF_COOKIE_SECURE в True. 
Это позволит обеспечить пересылку данных cookies только через протокол HTTPS.

Валидация заголовка Host
Использует ALLOWED_HOSTS чтобы принимать только запросы от доверенных хостов.